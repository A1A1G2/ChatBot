MODE: train
===========

Preparing data...
Total batches per epoch: 119
Total pairs skipped: 7989
2023-05-22 21:53:04.751115: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 159783936 exceeds 10% of free system memory.
2023-05-22 21:53:04.815362: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 159783936 exceeds 10% of free system memory.
Epoch 1 Batch 0 Loss 2.6462 Accuracy 0.1090
2023-05-22 21:53:05.373872: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 159783936 exceeds 10% of free system memory.
2023-05-22 21:53:05.427210: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 159783936 exceeds 10% of free system memory.
2023-05-22 21:53:05.947320: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 159783936 exceeds 10% of free system memory.
Epoch 1 Batch 100 Loss 2.4189 Accuracy 0.1278
Epoch 1 Loss 2.3825 Accuracy 0.1294
Time taken for 1 epoch: 92.74295616149902 secs

Epoch 2 Batch 0 Loss 1.7692 Accuracy 0.1310
Epoch 2 Batch 100 Loss 1.9453 Accuracy 0.1449
Epoch 2 Loss 1.9456 Accuracy 0.1455
Time taken for 1 epoch: 74.84113645553589 secs

Epoch 3 Batch 0 Loss 1.6318 Accuracy 0.1378
Epoch 3 Batch 100 Loss 1.7968 Accuracy 0.1511
Epoch 3 Loss 1.7986 Accuracy 0.1517
Time taken for 1 epoch: 73.69962644577026 secs

Epoch 4 Batch 0 Loss 1.5407 Accuracy 0.1446
Epoch 4 Batch 100 Loss 1.6911 Accuracy 0.1563
Epoch 4 Loss 1.6926 Accuracy 0.1569
Time taken for 1 epoch: 82.66604781150818 secs

Epoch 5 Batch 0 Loss 1.4454 Accuracy 0.1466
Epoch 5 Batch 100 Loss 1.6043 Accuracy 0.1606
Saving checkpoint for epoch 5 at ./checkpoints/train/ckpt-68
Epoch 5 Loss 1.6058 Accuracy 0.1609
Time taken for 1 epoch: 90.36918473243713 secs

Epoch 6 Batch 0 Loss 1.3876 Accuracy 0.1518
Epoch 6 Batch 100 Loss 1.5312 Accuracy 0.1647
Epoch 6 Loss 1.5328 Accuracy 0.1649
Time taken for 1 epoch: 79.32250595092773 secs

Epoch 7 Batch 0 Loss 1.3277 Accuracy 0.1518
Epoch 7 Batch 100 Loss 1.4682 Accuracy 0.1679
Epoch 7 Loss 1.4693 Accuracy 0.1681
Time taken for 1 epoch: 86.66701436042786 secs

Epoch 8 Batch 0 Loss 1.2722 Accuracy 0.1579
Epoch 8 Batch 100 Loss 1.4121 Accuracy 0.1722
Epoch 8 Loss 1.4134 Accuracy 0.1725
Time taken for 1 epoch: 82.29815888404846 secs

Epoch 9 Batch 0 Loss 1.2213 Accuracy 0.1643
Epoch 9 Batch 100 Loss 1.3634 Accuracy 0.1755
Epoch 9 Loss 1.3648 Accuracy 0.1757
Time taken for 1 epoch: 88.05213403701782 secs

Epoch 10 Batch 0 Loss 1.1891 Accuracy 0.1675
Epoch 10 Batch 100 Loss 1.3204 Accuracy 0.1804
Saving checkpoint for epoch 10 at ./checkpoints/train/ckpt-69
Epoch 10 Loss 1.3215 Accuracy 0.1806
Time taken for 1 epoch: 85.12844896316528 secs

Epoch 11 Batch 0 Loss 1.1330 Accuracy 0.1795
Epoch 11 Batch 100 Loss 1.2827 Accuracy 0.1848
Epoch 11 Loss 1.2829 Accuracy 0.1851
Time taken for 1 epoch: 76.17027878761292 secs

Epoch 12 Batch 0 Loss 1.0955 Accuracy 0.1819
Epoch 12 Batch 100 Loss 1.2474 Accuracy 0.1903
Epoch 12 Loss 1.2474 Accuracy 0.1906
Time taken for 1 epoch: 75.64424347877502 secs

Epoch 13 Batch 0 Loss 1.0734 Accuracy 0.1859
Epoch 13 Batch 100 Loss 1.2163 Accuracy 0.1944
Epoch 13 Loss 1.2162 Accuracy 0.1950
Time taken for 1 epoch: 77.45934796333313 secs

Epoch 14 Batch 0 Loss 1.0646 Accuracy 0.1827
Epoch 14 Batch 100 Loss 1.1883 Accuracy 0.1986
Epoch 14 Loss 1.1880 Accuracy 0.1991
Time taken for 1 epoch: 77.60116672515869 secs

Epoch 15 Batch 0 Loss 1.0351 Accuracy 0.1879
Epoch 15 Batch 100 Loss 1.1616 Accuracy 0.2028
Saving checkpoint for epoch 15 at ./checkpoints/train/ckpt-70
Epoch 15 Loss 1.1614 Accuracy 0.2034
Time taken for 1 epoch: 81.25325083732605 secs

Epoch 16 Batch 0 Loss 1.0005 Accuracy 0.1943
Epoch 16 Batch 100 Loss 1.1393 Accuracy 0.2064
Epoch 16 Loss 1.1391 Accuracy 0.2068
Time taken for 1 epoch: 81.27371025085449 secs

Epoch 17 Batch 0 Loss 0.9718 Accuracy 0.2023
Epoch 17 Batch 100 Loss 1.1173 Accuracy 0.2098
Epoch 17 Loss 1.1173 Accuracy 0.2102
Time taken for 1 epoch: 81.13058280944824 secs

Epoch 18 Batch 0 Loss 0.9503 Accuracy 0.2023
Epoch 18 Batch 100 Loss 1.0985 Accuracy 0.2127
Epoch 18 Loss 1.0986 Accuracy 0.2132
Time taken for 1 epoch: 88.77584838867188 secs

Epoch 19 Batch 0 Loss 0.9545 Accuracy 0.2035
Epoch 19 Batch 100 Loss 1.0801 Accuracy 0.2159
Epoch 19 Loss 1.0795 Accuracy 0.2164
Time taken for 1 epoch: 79.6584792137146 secs

Epoch 20 Batch 0 Loss 0.9193 Accuracy 0.2107
Epoch 20 Batch 100 Loss 1.0625 Accuracy 0.2186
Saving checkpoint for epoch 20 at ./checkpoints/train/ckpt-71
Epoch 20 Loss 1.0624 Accuracy 0.2192
Time taken for 1 epoch: 83.38063549995422 secs

Epoch 21 Batch 0 Loss 0.9173 Accuracy 0.2115
Epoch 21 Batch 100 Loss 1.0462 Accuracy 0.2212
Epoch 21 Loss 1.0461 Accuracy 0.2215
Time taken for 1 epoch: 78.4043197631836 secs

Epoch 22 Batch 0 Loss 0.8918 Accuracy 0.2139
Epoch 22 Batch 100 Loss 1.0313 Accuracy 0.2241
Epoch 22 Loss 1.0312 Accuracy 0.2245
Time taken for 1 epoch: 77.21895599365234 secs

Epoch 23 Batch 0 Loss 0.8829 Accuracy 0.2151
Epoch 23 Batch 100 Loss 1.0181 Accuracy 0.2258
Epoch 23 Loss 1.0177 Accuracy 0.2263
Time taken for 1 epoch: 77.99865508079529 secs

Epoch 24 Batch 0 Loss 0.8835 Accuracy 0.2131
Epoch 24 Batch 100 Loss 1.0017 Accuracy 0.2287
Epoch 24 Loss 1.0019 Accuracy 0.2293
Time taken for 1 epoch: 84.9218225479126 secs

Epoch 25 Batch 0 Loss 0.8640 Accuracy 0.2220
Epoch 25 Batch 100 Loss 0.9915 Accuracy 0.2310
Saving checkpoint for epoch 25 at ./checkpoints/train/ckpt-72
Epoch 25 Loss 0.9909 Accuracy 0.2315
Time taken for 1 epoch: 76.75461101531982 secs

Epoch 26 Batch 0 Loss 0.8467 Accuracy 0.2151
Epoch 26 Batch 100 Loss 0.9776 Accuracy 0.2332
Epoch 26 Loss 0.9777 Accuracy 0.2335
Time taken for 1 epoch: 88.08131885528564 secs

Epoch 27 Batch 0 Loss 0.8374 Accuracy 0.2228
Epoch 27 Batch 100 Loss 0.9674 Accuracy 0.2338
Epoch 27 Loss 0.9667 Accuracy 0.2345
Time taken for 1 epoch: 87.62042093276978 secs

Epoch 28 Batch 0 Loss 0.8223 Accuracy 0.2228
Epoch 28 Batch 100 Loss 0.9559 Accuracy 0.2364
Epoch 28 Loss 0.9556 Accuracy 0.2368
Time taken for 1 epoch: 83.63772201538086 secs

Epoch 29 Batch 0 Loss 0.8116 Accuracy 0.2240
Epoch 29 Batch 100 Loss 0.9449 Accuracy 0.2376
Epoch 29 Loss 0.9444 Accuracy 0.2383
Time taken for 1 epoch: 83.69661021232605 secs

Epoch 30 Batch 0 Loss 0.8035 Accuracy 0.2276
Epoch 30 Batch 100 Loss 0.9343 Accuracy 0.2395
Saving checkpoint for epoch 30 at ./checkpoints/train/ckpt-73
Epoch 30 Loss 0.9342 Accuracy 0.2399
Time taken for 1 epoch: 84.98381519317627 secs

Epoch 31 Batch 0 Loss 0.8017 Accuracy 0.2252
Epoch 31 Batch 100 Loss 0.9252 Accuracy 0.2419
Epoch 31 Loss 0.9251 Accuracy 0.2421
Time taken for 1 epoch: 84.66229939460754 secs

Epoch 32 Batch 0 Loss 0.7841 Accuracy 0.2328
Epoch 32 Batch 100 Loss 0.9146 Accuracy 0.2429
Epoch 32 Loss 0.9144 Accuracy 0.2434
Time taken for 1 epoch: 82.36499834060669 secs

Epoch 33 Batch 0 Loss 0.7941 Accuracy 0.2264
Epoch 33 Batch 100 Loss 0.9058 Accuracy 0.2448
Epoch 33 Loss 0.9052 Accuracy 0.2454
Time taken for 1 epoch: 85.29102325439453 secs

Epoch 34 Batch 0 Loss 0.7715 Accuracy 0.2320
Epoch 34 Batch 100 Loss 0.8950 Accuracy 0.2459
Epoch 34 Loss 0.8944 Accuracy 0.2467
Time taken for 1 epoch: 81.53861808776855 secs

Epoch 35 Batch 0 Loss 0.7605 Accuracy 0.2360
Epoch 35 Batch 100 Loss 0.8874 Accuracy 0.2478
Saving checkpoint for epoch 35 at ./checkpoints/train/ckpt-74
Epoch 35 Loss 0.8872 Accuracy 0.2481
Time taken for 1 epoch: 76.93609309196472 secs

Epoch 36 Batch 0 Loss 0.7405 Accuracy 0.2348
Epoch 36 Batch 100 Loss 0.8782 Accuracy 0.2487
Epoch 36 Loss 0.8784 Accuracy 0.2492
Time taken for 1 epoch: 82.50735282897949 secs

Epoch 37 Batch 0 Loss 0.7379 Accuracy 0.2448
Epoch 37 Batch 100 Loss 0.8698 Accuracy 0.2517
Epoch 37 Loss 0.8697 Accuracy 0.2520
Time taken for 1 epoch: 774.5453743934631 secs

Epoch 38 Batch 0 Loss 0.7222 Accuracy 0.2424
Epoch 38 Batch 100 Loss 0.8617 Accuracy 0.2519
Epoch 38 Loss 0.8614 Accuracy 0.2524
Time taken for 1 epoch: 93.70755553245544 secs

Epoch 39 Batch 0 Loss 0.7349 Accuracy 0.2384
Epoch 39 Batch 100 Loss 0.8544 Accuracy 0.2531
Epoch 39 Loss 0.8541 Accuracy 0.2537
Time taken for 1 epoch: 93.99984169006348 secs

Epoch 40 Batch 0 Loss 0.7384 Accuracy 0.2380
Epoch 40 Batch 100 Loss 0.8460 Accuracy 0.2547
Saving checkpoint for epoch 40 at ./checkpoints/train/ckpt-75
Epoch 40 Loss 0.8459 Accuracy 0.2553
Time taken for 1 epoch: 94.8127748966217 secs

Epoch 41 Batch 0 Loss 0.7089 Accuracy 0.2400
Epoch 41 Batch 100 Loss 0.8382 Accuracy 0.2559
Epoch 41 Loss 0.8387 Accuracy 0.2562
Time taken for 1 epoch: 94.71003246307373 secs

Epoch 42 Batch 0 Loss 0.7305 Accuracy 0.2400
Epoch 42 Batch 100 Loss 0.8323 Accuracy 0.2574
Epoch 42 Loss 0.8322 Accuracy 0.2578
Time taken for 1 epoch: 93.70780348777771 secs

Epoch 43 Batch 0 Loss 0.7035 Accuracy 0.2472
Epoch 43 Batch 100 Loss 0.8240 Accuracy 0.2584
Epoch 43 Loss 0.8240 Accuracy 0.2588
Time taken for 1 epoch: 94.69982171058655 secs

Epoch 44 Batch 0 Loss 0.6999 Accuracy 0.2444
Epoch 44 Batch 100 Loss 0.8186 Accuracy 0.2598
Epoch 44 Loss 0.8186 Accuracy 0.2602
Time taken for 1 epoch: 93.89366149902344 secs

Epoch 45 Batch 0 Loss 0.6889 Accuracy 0.2432
Epoch 45 Batch 100 Loss 0.8111 Accuracy 0.2613
Saving checkpoint for epoch 45 at ./checkpoints/train/ckpt-76
Epoch 45 Loss 0.8110 Accuracy 0.2618
Time taken for 1 epoch: 97.13072419166565 secs

Epoch 46 Batch 0 Loss 0.6890 Accuracy 0.2436
Epoch 46 Batch 100 Loss 0.8050 Accuracy 0.2623
Epoch 46 Loss 0.8058 Accuracy 0.2627
Time taken for 1 epoch: 98.39666652679443 secs

Epoch 47 Batch 0 Loss 0.6869 Accuracy 0.2464
Epoch 47 Batch 100 Loss 0.7986 Accuracy 0.2633
Epoch 47 Loss 0.7988 Accuracy 0.2638
Time taken for 1 epoch: 95.53668737411499 secs

Epoch 48 Batch 0 Loss 0.6795 Accuracy 0.2500
Epoch 48 Batch 100 Loss 0.7913 Accuracy 0.2647
Epoch 48 Loss 0.7911 Accuracy 0.2653
Time taken for 1 epoch: 92.26193284988403 secs

Epoch 49 Batch 0 Loss 0.6573 Accuracy 0.2524
Epoch 49 Batch 100 Loss 0.7844 Accuracy 0.2658
Epoch 49 Loss 0.7842 Accuracy 0.2663
Time taken for 1 epoch: 90.42436146736145 secs

Epoch 50 Batch 0 Loss 0.6871 Accuracy 0.2456
Epoch 50 Batch 100 Loss 0.7777 Accuracy 0.2668
Saving checkpoint for epoch 50 at ./checkpoints/train/ckpt-77
Epoch 50 Loss 0.7781 Accuracy 0.2672
Time taken for 1 epoch: 95.11020731925964 secs

Epoch 51 Batch 0 Loss 0.6687 Accuracy 0.2492
Epoch 51 Batch 100 Loss 0.7728 Accuracy 0.2682
Epoch 51 Loss 0.7727 Accuracy 0.2684
Time taken for 1 epoch: 96.27276873588562 secs

Epoch 52 Batch 0 Loss 0.6508 Accuracy 0.2552
Epoch 52 Batch 100 Loss 0.7660 Accuracy 0.2693
Epoch 52 Loss 0.7662 Accuracy 0.2698
Time taken for 1 epoch: 94.03266167640686 secs

Epoch 53 Batch 0 Loss 0.6592 Accuracy 0.2516
Epoch 53 Batch 100 Loss 0.7608 Accuracy 0.2697
Epoch 53 Loss 0.7612 Accuracy 0.2702
Time taken for 1 epoch: 96.63819408416748 secs

Epoch 54 Batch 0 Loss 0.6593 Accuracy 0.2512
Epoch 54 Batch 100 Loss 0.7548 Accuracy 0.2708
Epoch 54 Loss 0.7554 Accuracy 0.2713
Time taken for 1 epoch: 92.57113099098206 secs

Epoch 55 Batch 0 Loss 0.6417 Accuracy 0.2596
Epoch 55 Batch 100 Loss 0.7488 Accuracy 0.2723
Saving checkpoint for epoch 55 at ./checkpoints/train/ckpt-78
Epoch 55 Loss 0.7486 Accuracy 0.2728
Time taken for 1 epoch: 97.37656450271606 secs

Epoch 56 Batch 0 Loss 0.6447 Accuracy 0.2592
Epoch 56 Batch 100 Loss 0.7434 Accuracy 0.2736
Epoch 56 Loss 0.7434 Accuracy 0.2740
Time taken for 1 epoch: 89.58877992630005 secs

Epoch 57 Batch 0 Loss 0.6311 Accuracy 0.2552
Epoch 57 Batch 100 Loss 0.7377 Accuracy 0.2738
Epoch 57 Loss 0.7383 Accuracy 0.2743
Time taken for 1 epoch: 90.35750675201416 secs

Epoch 58 Batch 0 Loss 0.6369 Accuracy 0.2564
Epoch 58 Batch 100 Loss 0.7332 Accuracy 0.2752
Epoch 58 Loss 0.7325 Accuracy 0.2759
Time taken for 1 epoch: 92.4482946395874 secs

Epoch 59 Batch 0 Loss 0.6204 Accuracy 0.2580
Epoch 59 Batch 100 Loss 0.7276 Accuracy 0.2762
Epoch 59 Loss 0.7279 Accuracy 0.2764
Time taken for 1 epoch: 92.97726535797119 secs

Epoch 60 Batch 0 Loss 0.6190 Accuracy 0.2560
Epoch 60 Batch 100 Loss 0.7222 Accuracy 0.2776
Saving checkpoint for epoch 60 at ./checkpoints/train/ckpt-79
Epoch 60 Loss 0.7217 Accuracy 0.2782
Time taken for 1 epoch: 94.29249095916748 secs

Epoch 61 Batch 0 Loss 0.6222 Accuracy 0.2600
Epoch 61 Batch 100 Loss 0.7165 Accuracy 0.2782
Epoch 61 Loss 0.7166 Accuracy 0.2786
Time taken for 1 epoch: 88.35564064979553 secs

Epoch 62 Batch 0 Loss 0.6153 Accuracy 0.2572
Epoch 62 Batch 100 Loss 0.7122 Accuracy 0.2790
Epoch 62 Loss 0.7128 Accuracy 0.2793
Time taken for 1 epoch: 92.01141309738159 secs

Epoch 63 Batch 0 Loss 0.6115 Accuracy 0.2600
Epoch 63 Batch 100 Loss 0.7079 Accuracy 0.2802
Epoch 63 Loss 0.7073 Accuracy 0.2806
Time taken for 1 epoch: 96.97709202766418 secs

Epoch 64 Batch 0 Loss 0.5988 Accuracy 0.2628
self.createTrainingData(config_path)Epoch 64 Batch 100 Loss 0.7024 Accuracy 0.2811
Epoch 64 Loss 0.7023 Accuracy 0.2816
Time taken for 1 epoch: 94.96793246269226 secs

Epoch 65 Batch 0 Loss 0.6183 Accuracy 0.2608
Epoch 65 Batch 100 Loss 0.6973 Accuracy 0.2818
Saving checkpoint for epoch 65 at ./checkpoints/train/ckpt-80
Epoch 65 Loss 0.6976 Accuracy 0.2821
Time taken for 1 epoch: 90.40443444252014 secs

Epoch 66 Batch 0 Loss 0.5896 Accuracy 0.2624
Epoch 66 Batch 100 Loss 0.6928 Accuracy 0.2829
^CError: Unknown error occured.